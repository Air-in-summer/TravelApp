<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:TravelApplication.ViewModels"
             xmlns:models="clr-namespace:TravelApplication.Models"
             x:Class="TravelApplication.Pages.MajorPage.AddTripDestinationPage"
             x:DataType="viewmodels:AddTripDestinationViewModel"
             x:Name="AddTripDestinationPages"
             Title="Choose Destination"
             BackgroundColor="#F5F5F5">

    <Grid RowDefinitions="Auto,*" Padding="20,15">
        <!-- Search Bar -->
        <Border Grid.Row="0"
                StrokeThickness="0"
                BackgroundColor="White"
                Margin="0,0,0,20">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="15"/>
            </Border.StrokeShape>
            <Border.Shadow>
                <Shadow Brush="Black" Opacity="0.1" Radius="10" Offset="0,2"/>
            </Border.Shadow>
            <SearchBar Placeholder="ðŸ” Search for a city or province..."
                       Text="{Binding SearchQuery}"
                       SearchCommand="{Binding SearchCommand}"
                       BackgroundColor="Transparent"
                       PlaceholderColor="#9E9E9E"
                       TextColor="#212121"/>
        </Border>

        <!-- Results List -->
        <CollectionView Grid.Row="1"
                        ItemsSource="{Binding Results}"                       
                        SelectionMode="None">
            <CollectionView.EmptyView>
                <VerticalStackLayout Padding="20" 
                                    VerticalOptions="Center"
                                    HorizontalOptions="Center"
                                    Spacing="15">
                    <Border WidthRequest="100"
                            HeightRequest="100"
                            BackgroundColor="#E3F2FD"
                            StrokeThickness="0"
                            HorizontalOptions="Center">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="50"/>
                        </Border.StrokeShape>
                        <Label Text="ðŸŒ" 
                               FontSize="50"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                    </Border>
                    <Label Text="Find your destination"
                           HorizontalOptions="Center"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="#212121"/>
                    <Label Text="Start typing to search for cities and provinces"
                           HorizontalOptions="Center"
                           FontSize="14"
                           TextColor="#757575"
                           HorizontalTextAlignment="Center"/>
                </VerticalStackLayout>
            </CollectionView.EmptyView>
            
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:GeoapifyResult">
                    <Border Padding="0" 
                            Margin="0,0,0,12"
                            StrokeThickness="0"
                            BackgroundColor="White">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="15"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="Black"
                                    Opacity="0.08"
                                    Radius="10"
                                    Offset="0,2"/>
                        </Border.Shadow>
                        
                        <Grid Padding="18"
                              ColumnDefinitions="Auto,*,Auto"
                              ColumnSpacing="15">
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding GoToAddTripCommand, Source={x:Reference AddTripDestinationPages}}"
                                                      CommandParameter="{Binding .}"/>
                            </Grid.GestureRecognizers>

                            <!-- Icon -->
                            <Border Grid.Column="0"
                                    WidthRequest="56"
                                    HeightRequest="56"
                                    BackgroundColor="#E3F2FD"
                                    StrokeThickness="0"
                                    VerticalOptions="Center">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="28"/>
                                </Border.StrokeShape>
                                <Label Text="ðŸ“"
                                       FontSize="28"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>

                            <!-- Destination Info -->
                            <VerticalStackLayout Grid.Column="1"
                                               VerticalOptions="Center"
                                               Spacing="4">
                                <Label Text="{Binding DisplayName}" 
                                       FontAttributes="Bold"
                                       FontSize="17"
                                       TextColor="#212121"
                                       LineBreakMode="WordWrap"
                                       MaxLines="2"/>
                            </VerticalStackLayout>

                            <!-- Arrow Icon -->
                            <Border Grid.Column="2"
                                    WidthRequest="32"
                                    HeightRequest="32"
                                    BackgroundColor="#E3F2FD"
                                    StrokeThickness="0"
                                    VerticalOptions="Center">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="16"/>
                                </Border.StrokeShape>
                                <Label Text="â€º"
                                       FontSize="24"
                                       TextColor="#2196F3"
                                       FontAttributes="Bold"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>

</ContentPage>